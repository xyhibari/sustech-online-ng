<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/logo-assets/touch/homescreen192.png"><meta name="theme-color" content="#49BF7C"><link rel="manifest" href="/manifest.webmanifest"><meta prefix="og: http://ogp.me/ns#" property="og:type" content="article"><meta prefix="og: http://ogp.me/ns#" property="og:image" content="https://mirrors.sustech.edu.cn/git/sustech-online/sustech-online-ng/-/raw/master/docs/assets/og-image.png"><meta prefix="og: http://ogp.me/ns#" property="og:article:author" content="sustech.online"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/logo-assets/touch/homescreen168.png"><meta name="msapplication-TileImage" content="/logo-assets/touch/homescreen144.png"><meta name="msapplication-TileColor" content="#49BF7C"><meta name="google-site-verification" content="Av-srANCmFA_yZ8Iasa1yQsIPJCF_zlP5AoD35m6_Ww"><script async src="https://www.googletagmanager.com/gtag/js?id=G-1BQBXDGY3R"></script><script>
                        window.dataLayer = window.dataLayer || [];
                        function gtag(){dataLayer.push(arguments);}
                        gtag('js', new Date());
                        gtag('config', 'G-1BQBXDGY3R');
                        </script><script src="/wx_helper.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script><link rel="stylesheet" type="text/css" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script src="https://lib.baomitu.com/datatables/1.10.21/js/jquery.dataTables.min.js"></script><link rel="stylesheet" type="text/css" href="https://lib.baomitu.com/datatables/1.10.21/css/jquery.dataTables.min.css"><title>校内远程桌面使用指北 | 南科手册</title><meta name="description" content="Online manual for sustecher">
    <link rel="modulepreload" href="/assets/app.4f607c78.js"><link rel="modulepreload" href="/assets/index.html.7f9f088a.js"><link rel="modulepreload" href="/assets/index.html.ee748dfa.js"><link rel="prefetch" href="/assets/index.html.cc87eaf3.js"><link rel="prefetch" href="/assets/index.html.31611c34.js"><link rel="prefetch" href="/assets/2018-2019.html.14fd1851.js"><link rel="prefetch" href="/assets/2019-2020.html.d505a0cd.js"><link rel="prefetch" href="/assets/2020-2021.html.11c03637.js"><link rel="prefetch" href="/assets/2021-2022.html.286a08c4.js"><link rel="prefetch" href="/assets/2021fall.html.10103da6.js"><link rel="prefetch" href="/assets/index.html.bc939c40.js"><link rel="prefetch" href="/assets/index.html.080956c8.js"><link rel="prefetch" href="/assets/index.html.a8189774.js"><link rel="prefetch" href="/assets/index.html.5cac632f.js"><link rel="prefetch" href="/assets/building-11-elevator.html.c9409b54.js"><link rel="prefetch" href="/assets/2021.html.f6607a41.js"><link rel="prefetch" href="/assets/index.html.d0c1671e.js"><link rel="prefetch" href="/assets/index.html.57e12579.js"><link rel="prefetch" href="/assets/vehicle-charger.html.bfb1895c.js"><link rel="prefetch" href="/assets/index.html.0c8d0748.js"><link rel="prefetch" href="/assets/index.html.fd078231.js"><link rel="prefetch" href="/assets/index.html.70d3e1bf.js"><link rel="prefetch" href="/assets/index.html.10076f05.js"><link rel="prefetch" href="/assets/registered-organization-2019.html.39b87df9.js"><link rel="prefetch" href="/assets/registered-organization-2020.html.a4bcb362.js"><link rel="prefetch" href="/assets/registered-organization-2021.html.0638a2c2.js"><link rel="prefetch" href="/assets/index.html.3b65d196.js"><link rel="prefetch" href="/assets/index.html.f26770e4.js"><link rel="prefetch" href="/assets/index.html.1616e1b0.js"><link rel="prefetch" href="/assets/paper-tools.html.380435e4.js"><link rel="prefetch" href="/assets/index.html.0c88fc53.js"><link rel="prefetch" href="/assets/index.html.e58078a8.js"><link rel="prefetch" href="/assets/bustimer-wx.html.1f4934cf.js"><link rel="prefetch" href="/assets/bustimer.html.06da7a48.js"><link rel="prefetch" href="/assets/holiday.html.a86b78c8.js"><link rel="prefetch" href="/assets/redirect.html.c057676f.js"><link rel="prefetch" href="/assets/workday.html.8ab74050.js"><link rel="prefetch" href="/assets/index.html.e0f4ce56.js"><link rel="prefetch" href="/assets/index.html.aa4aced9.js"><link rel="prefetch" href="/assets/新生攻略之宿舍生活篇.html.8a1e73d0.js"><link rel="prefetch" href="/assets/新生攻略之校内介绍篇.html.fb3f1959.js"><link rel="prefetch" href="/assets/新生攻略之社团篇.html.bf5ca49a.js"><link rel="prefetch" href="/assets/index.html.e31e4c9c.js"><link rel="prefetch" href="/assets/index.html.be60fc1c.js"><link rel="prefetch" href="/assets/dorm-floor-plan.html.540dc6bf.js"><link rel="prefetch" href="/assets/index.html.1805cec9.js"><link rel="prefetch" href="/assets/index.html.dfea0af0.js"><link rel="prefetch" href="/assets/index.html.5e428f2f.js"><link rel="prefetch" href="/assets/index.html.432e1d7d.js"><link rel="prefetch" href="/assets/send-receive-email-by-proxy.html.571c2c6d.js"><link rel="prefetch" href="/assets/index.html.2e4cff86.js"><link rel="prefetch" href="/assets/index.html.c9e01786.js"><link rel="prefetch" href="/assets/index.html.57af03a4.js"><link rel="prefetch" href="/assets/index.html.3151a618.js"><link rel="prefetch" href="/assets/index.html.d481400a.js"><link rel="prefetch" href="/assets/index.html.2485a413.js"><link rel="prefetch" href="/assets/index.html.ec1da8be.js"><link rel="prefetch" href="/assets/index.html.fbde79b0.js"><link rel="prefetch" href="/assets/index.html.dffd6115.js"><link rel="prefetch" href="/assets/index.html.d93bcb6a.js"><link rel="prefetch" href="/assets/index.html.f1b81ea4.js"><link rel="prefetch" href="/assets/index.html.58162bd5.js"><link rel="prefetch" href="/assets/advice-on-study.html.9009e622.js"><link rel="prefetch" href="/assets/info-on-study.html.5495438f.js"><link rel="prefetch" href="/assets/新生攻略之学习篇.html.33503560.js"><link rel="prefetch" href="/assets/innovative-project.html.f4c44120.js"><link rel="prefetch" href="/assets/index.html.bf358557.js"><link rel="prefetch" href="/assets/index.html.43bedae8.js"><link rel="prefetch" href="/assets/index.html.a7f33103.js"><link rel="prefetch" href="/assets/index.html.aa3a5ae8.js"><link rel="prefetch" href="/assets/index.html.0a3d4b89.js"><link rel="prefetch" href="/assets/index.html.0d9facc0.js"><link rel="prefetch" href="/assets/index.html.ebd75eb6.js"><link rel="prefetch" href="/assets/index.html.78fee194.js"><link rel="prefetch" href="/assets/404.html.c3e557d0.js"><link rel="prefetch" href="/assets/index.html.84d00e53.js"><link rel="prefetch" href="/assets/index.html.9cdce4a3.js"><link rel="prefetch" href="/assets/2018-2019.html.e5fc4a7d.js"><link rel="prefetch" href="/assets/2019-2020.html.a793b958.js"><link rel="prefetch" href="/assets/2020-2021.html.317b6a93.js"><link rel="prefetch" href="/assets/2021-2022.html.ce04bbf1.js"><link rel="prefetch" href="/assets/2021fall.html.86758f8d.js"><link rel="prefetch" href="/assets/index.html.f99f66b9.js"><link rel="prefetch" href="/assets/index.html.903d05fb.js"><link rel="prefetch" href="/assets/index.html.ca3777d6.js"><link rel="prefetch" href="/assets/index.html.80ffc0c1.js"><link rel="prefetch" href="/assets/building-11-elevator.html.bc3c8ade.js"><link rel="prefetch" href="/assets/2021.html.aebf94c6.js"><link rel="prefetch" href="/assets/index.html.452abe57.js"><link rel="prefetch" href="/assets/index.html.49dbeb39.js"><link rel="prefetch" href="/assets/vehicle-charger.html.5ead118c.js"><link rel="prefetch" href="/assets/index.html.0f604d45.js"><link rel="prefetch" href="/assets/index.html.c56dad32.js"><link rel="prefetch" href="/assets/index.html.6d8d637d.js"><link rel="prefetch" href="/assets/index.html.3f436bd6.js"><link rel="prefetch" href="/assets/registered-organization-2019.html.c2c45b53.js"><link rel="prefetch" href="/assets/registered-organization-2020.html.2deb1f13.js"><link rel="prefetch" href="/assets/registered-organization-2021.html.8081d59e.js"><link rel="prefetch" href="/assets/index.html.01ab4a06.js"><link rel="prefetch" href="/assets/index.html.591a270c.js"><link rel="prefetch" href="/assets/index.html.cc48827c.js"><link rel="prefetch" href="/assets/paper-tools.html.00c16213.js"><link rel="prefetch" href="/assets/index.html.40464a3c.js"><link rel="prefetch" href="/assets/index.html.5e0a4ca8.js"><link rel="prefetch" href="/assets/bustimer-wx.html.da0d59c7.js"><link rel="prefetch" href="/assets/bustimer.html.62666284.js"><link rel="prefetch" href="/assets/holiday.html.8c60b090.js"><link rel="prefetch" href="/assets/redirect.html.58d7612d.js"><link rel="prefetch" href="/assets/workday.html.8dfacc66.js"><link rel="prefetch" href="/assets/index.html.71f350b0.js"><link rel="prefetch" href="/assets/index.html.d5ab0bb5.js"><link rel="prefetch" href="/assets/新生攻略之宿舍生活篇.html.ff48d3d7.js"><link rel="prefetch" href="/assets/新生攻略之校内介绍篇.html.0465597c.js"><link rel="prefetch" href="/assets/新生攻略之社团篇.html.4094fbe4.js"><link rel="prefetch" href="/assets/index.html.c705a3c1.js"><link rel="prefetch" href="/assets/index.html.be66b2ea.js"><link rel="prefetch" href="/assets/dorm-floor-plan.html.105e9e31.js"><link rel="prefetch" href="/assets/index.html.bc72c89e.js"><link rel="prefetch" href="/assets/index.html.8a878f1e.js"><link rel="prefetch" href="/assets/index.html.180ae160.js"><link rel="prefetch" href="/assets/index.html.7048c958.js"><link rel="prefetch" href="/assets/send-receive-email-by-proxy.html.5cdedd6d.js"><link rel="prefetch" href="/assets/index.html.b6a237a4.js"><link rel="prefetch" href="/assets/index.html.98abb9de.js"><link rel="prefetch" href="/assets/index.html.6303e0cf.js"><link rel="prefetch" href="/assets/index.html.ce0abe31.js"><link rel="prefetch" href="/assets/index.html.cc325b4c.js"><link rel="prefetch" href="/assets/index.html.d2e82d39.js"><link rel="prefetch" href="/assets/index.html.1918e71d.js"><link rel="prefetch" href="/assets/index.html.0058ceed.js"><link rel="prefetch" href="/assets/index.html.57373b77.js"><link rel="prefetch" href="/assets/index.html.676e9693.js"><link rel="prefetch" href="/assets/index.html.71227b30.js"><link rel="prefetch" href="/assets/index.html.d76ae125.js"><link rel="prefetch" href="/assets/advice-on-study.html.1018482e.js"><link rel="prefetch" href="/assets/info-on-study.html.2a8a574c.js"><link rel="prefetch" href="/assets/新生攻略之学习篇.html.ef394bb3.js"><link rel="prefetch" href="/assets/innovative-project.html.30b1a003.js"><link rel="prefetch" href="/assets/index.html.fd8abde9.js"><link rel="prefetch" href="/assets/index.html.2f6f55e5.js"><link rel="prefetch" href="/assets/index.html.a331d339.js"><link rel="prefetch" href="/assets/index.html.e0b61009.js"><link rel="prefetch" href="/assets/index.html.9c83eec2.js"><link rel="prefetch" href="/assets/index.html.d2a515e5.js"><link rel="prefetch" href="/assets/index.html.f5cc0ed2.js"><link rel="prefetch" href="/assets/index.html.af3b9961.js"><link rel="prefetch" href="/assets/404.html.b4e681c2.js"><link rel="prefetch" href="/assets/index.0e8935cb.js">
    <link rel="stylesheet" href="/assets/style.13e12b53.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">南科手册</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://daily.sustech.online/" rel="noopener noreferrer" target="_blank" aria-label="快讯网"><!--[--><!--]--> 快讯网 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/miniapp/" class="" aria-label="小程序"><!--[--><!--]--> 小程序 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/site-help/" class="" aria-label="站点帮助"><!--[--><!--]--> 站点帮助 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/sustech-cra/sustech-online-ng" rel="noopener noreferrer" target="_blank" aria-label="在Github上查看"><!--[--><!--]--> 在Github上查看 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="切换夜间模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://daily.sustech.online/" rel="noopener noreferrer" target="_blank" aria-label="快讯网"><!--[--><!--]--> 快讯网 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/miniapp/" class="" aria-label="小程序"><!--[--><!--]--> 小程序 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/about/" class="" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/site-help/" class="" aria-label="站点帮助"><!--[--><!--]--> 站点帮助 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/sustech-cra/sustech-online-ng" rel="noopener noreferrer" target="_blank" aria-label="在Github上查看"><!--[--><!--]--> 在Github上查看 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/" class="sidebar-item sidebar-heading" aria-label="📚南科手册"><!--[--><!--]--> 📚南科手册 <!--[--><!--]--></a><!----></li><li><a href="/facility/" class="sidebar-item sidebar-heading" aria-label="🏫建筑与设施"><!--[--><!--]--> 🏫建筑与设施 <!--[--><!--]--></a><!----></li><li><a href="/contact/" class="sidebar-item sidebar-heading" aria-label="📇黄页"><!--[--><!--]--> 📇黄页 <!--[--><!--]--></a><!----></li><li><a href="/calendar/" class="sidebar-item sidebar-heading" aria-label="📅校历"><!--[--><!--]--> 📅校历 <!--[--><!--]--></a><!----></li><li><a href="/service/" class="router-link-active sidebar-item sidebar-heading" aria-label="🖥服务与技巧"><!--[--><!--]--> 🖥服务与技巧 <!--[--><!--]--></a><!----></li><li><a href="/life/" class="sidebar-item sidebar-heading" aria-label="👨‍🎓生活在南科"><!--[--><!--]--> 👨‍🎓生活在南科 <!--[--><!--]--></a><!----></li><li><a href="/study/" class="sidebar-item sidebar-heading" aria-label="🎓学在南科"><!--[--><!--]--> 🎓学在南科 <!--[--><!--]--></a><!----></li><li><a href="/organizations/" class="sidebar-item sidebar-heading" aria-label="🎡社团活动"><!--[--><!--]--> 🎡社团活动 <!--[--><!--]--></a><!----></li><li><a href="/media/" class="sidebar-item sidebar-heading" aria-label="📺媒体与网站"><!--[--><!--]--> 📺媒体与网站 <!--[--><!--]--></a><!----></li><li><a href="/transport/" class="sidebar-item sidebar-heading" aria-label="🚄交通"><!--[--><!--]--> 🚄交通 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a href="/transport/bustimer.md" class="sidebar-item" aria-label="🚌新版巴士时刻表"><!--[--><!--]--> 🚌新版巴士时刻表 <!--[--><!--]--></a><!----></li><li><a href="/transport/workday.md" class="sidebar-item" aria-label="🚌校园巴士-工作日"><!--[--><!--]--> 🚌校园巴士-工作日 <!--[--><!--]--></a><!----></li><li><a href="/transport/holiday.md" class="sidebar-item" aria-label="🚌校园巴士-节假日"><!--[--><!--]--> 🚌校园巴士-节假日 <!--[--><!--]--></a><!----></li><li><a href="/transport/" class="sidebar-item" aria-label="周围交通"><!--[--><!--]--> 周围交通 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/surroundings/" class="sidebar-item sidebar-heading" aria-label="🛍周边"><!--[--><!--]--> 🛍周边 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="校内远程桌面使用指北" tabindex="-1"><a class="header-anchor" href="#校内远程桌面使用指北" aria-hidden="true">#</a> 校内远程桌面使用指北</h1><p>by <a href="https://github.com/jerrylususu" target="_blank" rel="noopener noreferrer">@jerrylususu<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><div class="custom-container tip"><p class="custom-container-title">提示</p><p>本文初版写于2020年12月，文中所述内容可能已发生变化。请参考各贡献者的修订以获取最新情报。</p></div><h2 id="远程桌面是什么" tabindex="-1"><a class="header-anchor" href="#远程桌面是什么" aria-hidden="true">#</a> 远程桌面是什么？</h2><p>远程桌面，是一种远程访问技术，可以从其他设备连接到你的电脑，并访问所有应用、文件和资源，就像坐在自己的电脑前一样。换句话说，这是一项可以把不属于自己的设备（如机房电脑）当成自己的设备使用的技术。</p><p>作为一项技术，远程桌面有不同的实现。在 Windows 环境下，最常见的远程桌面实现为 Remote Desktop Protocol （RDP，远程桌面协议），Windows 为其提供了完善的支持。在 Linux 环境下，最常见的远程桌面实现为 Virtual Network Computing （VNC）。其他厂家也有自己的远程桌面实现，如 TeamViewer，AnyDesk，ToDesk，向日葵，甚至于 QQ 的「远程协助」。</p><p>本文将着眼于 Windows 环境下 RDP 的配置（即从 Windows 设备连接到 Windows 设备），这也是校内最常见的用例。</p><p>（若需要从 iOS / Android / Mac 端远程控制 Windows，可以直接在应用商店中搜索安装 RD Client，iPad 端最新版本支持完整的鼠标操作。若需要从 Windows 端远程控制 Mac，除了 Mac 提供的 VNC 之外，推荐使用流畅性更高的第三方软件，例如 NoMachine 等。）</p><h2 id="远程桌面的典型使用场景" tabindex="-1"><a class="header-anchor" href="#远程桌面的典型使用场景" aria-hidden="true">#</a> 远程桌面的典型使用场景</h2><ul><li>购买了重量较重的游戏本或不便于携带的台式机在宿舍，但是想从图书馆、实验室等位置使用。</li><li>在参加计算机系的实验课程时，使用宿舍或实验室内性能强大的设备进行编译操作，而不必被机房性能羸弱的电脑限制。</li><li>在图书馆专心复习时，仍能访问宿舍电脑上存储的课件、笔记、电子书等资料。</li><li>在教室 Pre 的时候发现自己忘了携带所需的资料，可以使用远程桌面从宿舍电脑上取回。</li><li>在校内有 WiFi 信号覆盖的位置使用远程桌面连接回宿舍电脑继续工作/学习，而无需手动维持不同设备（如笔记本和台式机）间的数据同步状态。</li><li>在宿舍床上使用 iPad 等平板类设备游玩床下电脑中的 Galgame。</li></ul><h2 id="不建议使用远程桌面的场景" tabindex="-1"><a class="header-anchor" href="#不建议使用远程桌面的场景" aria-hidden="true">#</a> 不建议使用远程桌面的场景</h2><ul><li>玩大型游戏、看电影/视频（RDP 主要为日常工作使用优化，变化频繁的画面使用 Steam Remote Play 等技术更适合）</li><li>复制体积较大的文件（RDP 对在不同设备间转移小文件十分合适，但文件体积过大可能造成网络阻塞，操作卡死。如有需要转移大文件的需求，可使用 <a href="https://www.appinn.com/landrop-files-transfer-tools/" target="_blank" rel="noopener noreferrer">LANDrop<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a>，<a href="https://send.cra.moe/" target="_blank" rel="noopener noreferrer">校内 Send 文件分享<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 等工具）</li></ul><blockquote><p>下称自己的设备为「服务端」，机房/教室/图书馆等的设备为「客户端」</p></blockquote><h2 id="服务端配置" tabindex="-1"><a class="header-anchor" href="#服务端配置" aria-hidden="true">#</a> 服务端配置</h2><ol><li><p><a href="https://support.microsoft.com/zh-cn/windows/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2-5fe128d5-8fb1-7a23-3b8a-41e636865e8c" target="_blank" rel="noopener noreferrer">开启「远程桌面」功能。<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a>（此功能需要专业版本 Windows，家庭版本可以使用 GitHub 上的开源工具 <a href="https://github.com/stascorp/rdpwrap" target="_blank" rel="noopener noreferrer">RDPWrap<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 开启此功能，<a href="https://www.iplaysoft.com/rdp-wrapper-library.html" target="_blank" rel="noopener noreferrer">教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a>)。</p><p>注：若按照教程仍然无法开启功能，则可能是服务端 <code>rdpwrap.ini</code> 文件与当前 Windows 版本不匹配，可以从 <a href="https://github.com/stascorp/rdpwrap/issues" target="_blank" rel="noopener noreferrer">Github Issues<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 或其他地方获取 <code>rdpwrap.ini</code> 文件并替换。详情可参考此 <a href="https://b23.tv/TTaRTD" target="_blank" rel="noopener noreferrer">B站视频演示<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a>。</p></li><li><p><a href="https://docs.microsoft.com/zh-cn/windows-server/remote/remote-desktop-services/clients/change-listening-port" target="_blank" rel="noopener noreferrer">设置远程桌面端口为非 3389 端口<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> ，并记住这个端口号 <s>（此为信息中心的限制，为防止病毒通过远程桌面传播，默认阻断了 3389 端口上的 TCP 链接）</s> ，此限制实测在工学院和慧园地区已取消，其他地区待认证。</p></li><li><p>查看并记录自己的 IP 地址：打开「任务管理器」，切换到「性能」标签页，在左侧找到「Wi-Fi」，在右侧找到「IPv4 地址」并记录。（通常为以小数点分割的一组数字，如 <code>10.XX.XX.XX</code>）</p></li></ol><blockquote><p>注：如有可能，建议使用网线直接连接。使用 WiFi 可能导致在高峰期时的延迟抖动。</p></blockquote><ol start="4"><li>（非必需设置）如果想从非校园网络访问远程设备，可以尝试使用 <a href="https://www.zerotier.com/" target="_blank" rel="noopener noreferrer">ZeroTier One<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 等软件 <a href="https://b23.tv/MzHzMi" target="_blank" rel="noopener noreferrer">配置内网穿透<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 功能。</li></ol><h3 id="一键开启远程桌面功能并修改端口为-13389-的注册表文件" tabindex="-1"><a class="header-anchor" href="#一键开启远程桌面功能并修改端口为-13389-的注册表文件" aria-hidden="true">#</a> 一键开启远程桌面功能并修改端口为 13389 的注册表文件:</h3><p>by <a href="https://github.com/BadBoyGuangzhi" target="_blank" rel="noopener noreferrer">@BadBoyGuangzhi<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><p>打开记事本，复制下方文本到记事本内，另存为 <code>xxx.reg</code> 文件，右键管理员运行即可（已经开启过的也可以使用此文件修改端口为13389，不会重复添加导致冲突）。或者也可以直接使用成品 <a href="https://raw.githubusercontent.com/SUSTC/sustech-online-ng/master/docs/files/rdp-13389.reg" target="_blank" rel="noopener noreferrer">点我下载成品<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server]
&quot;fDenyTSConnections&quot;=dword:00000000

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp]
&quot;PortNumber&quot;=dword:0000344d

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp]
&quot;PortNumber&quot;=dword:0000344d

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules]
&quot;{4043AE3F-5762-46B6-A755-23E34F020290}&quot;=&quot;v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=17|LPort=13389|Name=RDP-13389-UDP|&quot;

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\FirewallRules]
&quot;{8A4F4940-93E0-4BFC-B35F-2C89A6AD260F}&quot;=&quot;v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=6|LPort=13389|Name=RDP-13389-TCP|&quot;

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon]
&quot;DisableCAD&quot;=dword:00000001
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="从客户端连接" tabindex="-1"><a class="header-anchor" href="#从客户端连接" aria-hidden="true">#</a> 从客户端连接</h2><ol><li>在「开始」菜单中选择「Windows 附件 / 远程桌面」（或使用 <code>Win+R</code> 打开「运行」窗口，然后输入 <code>mstsc</code>，按下回车）</li><li>在「计算机」文本框中输入自己的 IP 和端口号，用英文冒号分割。（例：<code>10.XX.XX.XX:YYYY</code>）</li><li>点击「连接」按钮</li><li>在弹出的认证窗口中输入自己的用户名和密码（如果服务端使用的是微软账户，需要输入微软账户的邮箱和密码）</li><li>在证书确认窗口点击「是」</li><li>如果一切正常，应该能见到远程设备的桌面了。</li></ol><h3 id="用于在校内网通过邮箱获取服务端ip地址的-python-脚本" tabindex="-1"><a class="header-anchor" href="#用于在校内网通过邮箱获取服务端ip地址的-python-脚本" aria-hidden="true">#</a> 用于在校内网通过邮箱获取服务端IP地址的 <code>Python</code> 脚本:</h3><p>by <a href="https://github.com/KagaJiankui" target="_blank" rel="noopener noreferrer">@KagaJiankui<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><details class="custom-container details"><summary>获取IP的脚本</summary><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># coding: utf-8</span>

<span class="token keyword">import</span> smtplib
<span class="token keyword">import</span> time
<span class="token keyword">import</span> datetime
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText
<span class="token keyword">from</span> email<span class="token punctuation">.</span>header <span class="token keyword">import</span> Header
<span class="token keyword">import</span> socket

_local_ip <span class="token operator">=</span> <span class="token boolean">None</span>

mail_info <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&#39;recv_address&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;recv@example.sustech.com&#39;</span><span class="token punctuation">,</span> <span class="token comment">#你的接收端邮箱地址</span>
    <span class="token string">&#39;sender_name&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;send@example.sustech.com&#39;</span><span class="token punctuation">,</span> <span class="token comment">#你的发送端邮箱地址</span>
    <span class="token string">&#39;sender_pwd&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;authenticationcode&#39;</span><span class="token punctuation">,</span> <span class="token comment">#授权码（用于qq或163邮箱）</span>
    <span class="token string">&#39;smtp_server&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;smtp.example.com&#39;</span><span class="token punctuation">,</span> <span class="token comment">#smtp发送服务器（在邮箱帮助页面查看）</span>
    <span class="token string">&#39;subject&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;远程电脑IP信息已更新&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;content&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;您的校内网IP信息: {}&#39;</span>
<span class="token punctuation">}</span>


<span class="token keyword">def</span> <span class="token function">send_message</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 设置发送邮件的内容</span>
    msg <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token string">&#39;plain&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    msg<span class="token punctuation">[</span><span class="token string">&#39;From&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span>mail_info<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;sender_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg<span class="token punctuation">[</span><span class="token string">&#39;Subject&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span>mail_info<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;subject&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    msg<span class="token punctuation">[</span><span class="token string">&#39;To&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span>mail_info<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;recv_address&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 发送邮件</span>
    smtp <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span><span class="token punctuation">)</span>
    smtp<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>mail_info<span class="token punctuation">[</span><span class="token string">&#39;smtp_server&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    smtp<span class="token punctuation">.</span>login<span class="token punctuation">(</span>mail_info<span class="token punctuation">[</span><span class="token string">&#39;sender_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mail_info<span class="token punctuation">[</span><span class="token string">&#39;sender_pwd&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    smtp<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>mail_info<span class="token punctuation">[</span><span class="token string">&#39;sender_name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mail_info<span class="token punctuation">[</span><span class="token string">&#39;recv_address&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>msg<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        smtp<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> smtplib<span class="token punctuation">.</span>SMTPException <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        e <span class="token operator">=</span> <span class="token string">&quot;Failed to close SMTP session.&quot;</span>


<span class="token keyword">def</span> <span class="token function">get_host_ip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    这个方法是目前见过最优雅获取本机服务器的IP方法了。没有任何的依赖，也没有去猜测机器上的网络设备信息。
    而且是利用 UDP 协议来实现的，生成一个UDP包，把自己的 IP 放如到 UDP 协议头中，然后从UDP包中获取本机的IP。
    这个方法并不会真实的向外部发包，所以用抓包工具是看不到的。但是会申请一个 UDP 的端口，所以如果经常调用也会比较耗时的，这里如果需要可以将查询到的IP给缓存起来，性能可以获得很大提升。
    :return:
    &quot;&quot;&quot;</span>
    <span class="token keyword">global</span> _local_ip
    s <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> _local_ip<span class="token punctuation">:</span>
            s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">)</span>
            s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&#39;8.8.8.8&#39;</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            _local_ip <span class="token operator">=</span> s<span class="token punctuation">.</span>getsockname<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> _local_ip
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> s<span class="token punctuation">:</span>
            s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">mail_ip_send</span><span class="token punctuation">(</span>ip_real<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    使用邮件发送IP地址.
    &quot;&quot;&quot;</span>
    info_dict <span class="token operator">=</span> <span class="token string">&quot;校内网IP: &quot;</span> <span class="token operator">+</span> ip_real <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span>
        <span class="token string">&quot;%Y-%m-%d %H:%M:%S %Z&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>info_dict<span class="token punctuation">)</span>
    send_message<span class="token punctuation">(</span>info_dict<span class="token punctuation">)</span>


ip_val <span class="token operator">=</span> get_host_ip<span class="token punctuation">(</span><span class="token punctuation">)</span>
num <span class="token operator">=</span> <span class="token number">0</span>
seconds_sleep <span class="token operator">=</span> <span class="token number">5</span>  <span class="token comment"># 检测IP地址的时间间隔</span>
itr <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">3600</span> <span class="token operator">/</span> seconds_sleep  <span class="token comment"># IP地址无变动时默认发送邮件的小时数</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    ip_real <span class="token operator">=</span> get_host_ip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    h <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hour
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ip_real <span class="token operator">!=</span> ip_val<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>h <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;=</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment">#晚上3点到早7点之间不发送IP</span>
        mail_ip_send<span class="token punctuation">(</span>ip_real<span class="token punctuation">)</span>
        ip_val <span class="token operator">=</span> ip_real
    num <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">if</span> num <span class="token operator">&gt;=</span> itr<span class="token punctuation">:</span>
        mail_ip_send<span class="token punctuation">(</span>ip_real<span class="token punctuation">)</span>
        ip_val <span class="token operator">=</span> ip_real
        num <span class="token operator">=</span> <span class="token number">0</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>seconds_sleep<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>本脚本要求<code>python&gt;3.0</code> 与对应的依赖。建议使用您的私人邮箱而非学校提供的邮箱作为收发端。在您的台式机或游戏本上直接运行脚本：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ python ./mailer.py <span class="token comment">#将文件保存为mailer.py</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>该脚本便会自动检测当前IP地址并发送到您指定的接收端邮箱中。若检测到IP地址变动或经过您指定的等待小时数，脚本即重复发送IP地址。直接运行脚本会占用一个命令行窗口。如果想要隐藏该窗口，可使用 <a href="https://www.appinn.com/rbtray/" target="_blank" rel="noopener noreferrer">RBTray<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 等最小化至托盘类工具，或使用 <a href="https://www.appinn.com/rbtray/" target="_blank" rel="noopener noreferrer">NSSM<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 等工具将该脚本以系统服务的方式运行。</p><p>当您的移动端设备与您的主机连接到同一局域网时，您可以使用这个 IP 地址与对应的端口号连接到您的远程桌面、SSH、Jupyter 等应用的服务端。</p><h2 id="在图书馆使用远程桌面" tabindex="-1"><a class="header-anchor" href="#在图书馆使用远程桌面" aria-hidden="true">#</a> 在图书馆使用远程桌面</h2><p>在南科大的三个图书馆中，都有公共的电脑区域，使用此区域的电脑作为远程桌面的客户端也是不错的选择。（笔者自测可以提升 50% ~ 200% 不等的工作/学习效率。）</p><p>不同图书馆间电脑对比如下表。</p><table><thead><tr><th>图书馆</th><th>电脑设备数（约）</th><th>操作系统</th><th>屏幕分辨率</th><th>连接速度</th></tr></thead><tbody><tr><td>琳恩</td><td>~50</td><td>Windows 7</td><td>1080p, 100% DPI</td><td>百兆</td></tr><tr><td>一丹</td><td>~100</td><td>Windows 10</td><td>1080p, 125% DPI</td><td>千兆</td></tr><tr><td>涵泳</td><td>~10</td><td>Windows 10</td><td>1080p, 125% DPI</td><td>千兆</td></tr></tbody></table><p>在图书馆使用远程桌面的时候，以下几点可以帮助你获得更好的体验：</p><ol><li>如果觉得卡顿，可以在连接前在「体验」标签页中设置连接速度为 <code>WAN （10 Mbps 或更高速度，高延迟）</code> ，并取消勾选「拖动时显示窗口内容」和「菜单和窗口动画」。</li><li>可以携带一条有线耳机插入主机的前端耳机插口（通常为绿色），以在远程桌面中使从服务端获取音频（听歌）。注意每次连接的时候远端设备音量会被设置为 100。</li><li>使用完成后，在关闭远程桌面之外，最好手动关机/重启公用电脑。即使登出了公用电脑（恢复输入学号/密码界面），远程桌面的连接信息（IP，端口号，用户名等）依然会保存在远程桌面应用中，存在泄露个人信息的可能。</li><li>可以安装一个其他远程桌面软件（笔者自己使用 ToDesk）备用，以防因网络波动导致服务端 IP 改变无法连接。</li></ol><blockquote><p>注：在图书馆如果不想远程桌面，但是却想用公用电脑的屏幕，可以携带一根 HDMI / DP / miniDP 转 DVI 转接线。三个图书馆的公用电脑的屏幕的接口均为 VGA + DVI，其中 VGA 接口连接主机，DVI 接口未连接。不建议为了使用屏幕而断开连接主机的 VGA 线，这会为图书馆的维护人员带来困扰。</p></blockquote></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/sustech-cra/sustech-online-ng/edit/master/docs/service/network/remote-desktop/README.md" rel="noopener noreferrer" target="_blank" aria-label="一起完善这本手册！"><!--[--><!--]--> 一起完善这本手册！ <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 58453886+KagaJiankui@users.noreply.github.com">Falken Sakurai</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: jerrylu.mail@qq.com">Neko Null</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 58973019+Sakuranetin@users.noreply.github.com">Sakuranetin</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 87311458+BadBoyGuangzhi@users.noreply.github.com">BadBoyGuangzhi</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 11712709@mail.sustc.edu.cn">Neko Null</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: leezisy@gmail.com">liziwl</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: sparktour@outlook.com">sparkcyf</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.4f607c78.js" defer></script>
  </body>
</html>
